{% block gallery_widget %}
    <div class="lm-gallery" data-type="field" data-multiple="true" data-id="{{ entity_id }}" data-name-field="{{ form.vars.full_name }}">
        <div class="lm-gallery__wrapper">
            <div class="lm-gallery__panel">
                <div class="lm-gallery__actions">
                    <div class="lm-gallery__actions--left">
                        <button type="button" class="btn btn-primary lm-gallery__action lm-gallery__action--add"><i class="fa-solid fa-plus"></i></button>
                        <button type="button" class="btn btn-primary lm-gallery__action lm-gallery__action--add_category"><i class="fa-solid fa-layer-group"></i> Додати групу</button>
                    </div>
                    <div class="lm-gallery__actions--right">
                        <select class="lm-gallery__select_category">
                            <option value="0">Додати до групи</option>
                            <option value="none">Без категорії</option>
                            {% for category in categories %}
                                <option value="{{ category }}">{{ category }}</option>
                            {% endfor %}
                        </select>
                        <button type="button" class="btn lm-gallery__action lm-gallery__action--cancel">Cancel</button>
                        <button type="button" class="btn btn-danger lm-gallery__action lm-gallery__action--delete_selected">Delete selected</button>
                    </div>
                </div>
            </div>

            <div class="lm-gallery__categories">
                <div class="lm-card-category_media is--not_drag is--active" data-id="0" data-name="none">
                    <div class="lm-card-category_media__icon"></div>
                    Без категорії
                </div>
                {% for category in categories %}
                    <div class="lm-card-category_media" data-id="0" data-name="{{ category }}">
                        <input type="hidden" name="Portfolio[category_media][]" value="{{ category }}">
                        <div class="lm-card-category_media__icon"></div>
                        {{ category }}
                        <div class="lm-card-category_media__remove"><i class="fa-solid fa-xmark"></i></div>
                    </div>
                {% endfor %}
            </div>

            <div class="lm-gallery__items">
                {% if form.vars.value|length == 0 %}
                    <div class="lm-gallery__notification">
                        <i class="fa-solid fa-info-circle"></i>
                        <span>Click the button to add images</span>
                    </div>
                {% else %}
                    {% if medias|length > 0 %}
                        {% for media in medias %}
                            <div class="lm-card-media {{ (media.category is not null) ? 'is-hidden' : '' }}" data-category="{{ media.category.name|default('none') }}">
                                <input class="lm-card-media__checkbox_category" type="hidden" name="Portfolio[category_media_items][]" value="{{ media.category.name|default('none') }}_{{ media.media.id }}">
                                <input class="lm-card-media__checkbox" type="checkbox" id="{{ media.media.slug }}" name="{{ form.vars.full_name }}" value="{{ media.media.id }}" checked>
                                <label for="{{ media.media.slug }}" class="lm-card-media__label">
                                    <button class="lm-card-media__remove"></button>
                                    <img src="/{{ media.media.getThumbnail() }}" class="lm-item__image">
                                </label>
                            </div>
                        {% endfor %}
                    {% else %}
                        {% for media in form.vars.data %}
                            <div class="lm-card-media" data-category="none">
                                <input class="lm-card-media__checkbox_category" type="hidden" name="Portfolio[category_media_items][]" value="none_{{ media.id }}">
                                <input class="lm-card-media__checkbox" type="checkbox" id="{{ media.slug }}" name="{{ form.vars.full_name }}" value="{{ media.id }}" checked>
                                <label for="{{ media.slug }}" class="lm-card-media__label">
                                    <button class="lm-card-media__remove"></button>
                                    <img src="/{{ media.getThumbnail() }}" class="lm-item__image">
                                </label>
                            </div>
                        {% endfor %}
                    {% endif %}

{#                    {% for media in form.vars.data %}#}
{#                        <div class="lm-card-media" data-category="">#}
{#                            <input type="hidden" name="Portfolio[category_media_items][]" value="none_{{ media.id }}">#}
{#                            <input class="lm-card-media__checkbox" type="checkbox" id="{{ media.slug }}" name="{{ form.vars.full_name }}" value="{{ media.id }}" checked>#}
{#                            <label for="{{ media.slug }}" class="lm-card-media__label">#}
{#                                <button class="lm-card-media__remove"></button>#}
{#                                <img src="/{{ media.getThumbnail() }}" class="lm-item__image">#}
{#                            </label>#}
{#                        </div>#}
{#                    {% endfor %}#}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}